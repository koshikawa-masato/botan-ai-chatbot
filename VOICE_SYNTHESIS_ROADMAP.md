# 音声合成統合ロードマップ

**ブランチ**: `feature/voice-synthesis`
**目標バージョン**: v1.1.0
**予定期間**: 1-2ヶ月

---

## 🎯 Phase 1.1: 音声合成統合の目標

テキストベースの牡丹に「声」を与え、AI Vtuberへの第一歩を踏み出す。

### 達成目標
- [ ] ElevenLabs v3 API統合
- [ ] 牡丹の声の確立（kuon voice使用）
- [ ] テキスト→音声変換パイプライン
- [ ] 音声ファイル生成・再生システム
- [ ] 音声品質の最適化

---

## 📋 実装タスク

### Task 1: ElevenLabs API統合 ✅
**優先度**: 最高

- [x] ElevenLabs APIキー取得・設定
- [x] Python SDKインストール (`elevenlabs`)
- [x] API接続テスト
- [x] レート制限・エラーハンドリング実装
- [x] 環境変数による設定管理

**成果物**: `elevenlabs_client.py` ✅

---

### Task 2: 音声生成システム ✅
**優先度**: 高

- [x] テキスト→音声変換関数実装
- [x] 音声ファイル保存機能
- [x] 音声再生機能（ローカル）
- [x] キャッシュシステム（同じテキストの再生成回避）
- [x] ストリーミング再生対応

**成果物**: `voice_synthesis.py` ✅

---

### Task 3: 牡丹の声の確立 ✅
**優先度**: 高

- [x] kuon voiceの設定・調整
- [x] 感情表現の調整（喜び、驚き、通常）
- [x] イントネーション最適化
- [x] ギャル語の発音調整
- [x] 音声サンプル生成・評価

**成果物**: `.env`設定ファイル、テスト音声 ✅

---

### Task 4: チャットシステム統合
**優先度**: 中

- [ ] `chat_with_learning.py`への音声統合
- [ ] テキスト応答後の自動音声生成
- [ ] 音声ON/OFFオプション追加
- [ ] 音声生成中のインジケータ表示

**成果物**: `chat_with_learning.py` (音声対応版)

---

### Task 5: 音声評価システム
**優先度**: 中

- [ ] 音声品質の評価指標追加
- [ ] 自然さ・感情表現の評価
- [ ] 会話ログへの音声メタデータ記録
- [ ] 音声統計の収集

**成果物**: 音声評価機能追加

---

### Task 6: ドキュメント整備 ✅
**優先度**: 中

- [x] 音声合成セットアップガイド作成
- [x] ElevenLabs API使用方法ドキュメント
- [x] トラブルシューティング追加
- [ ] CHANGELOG更新（次回コミット時）

**成果物**: `VOICE_SETUP.md` ✅

---

## 🔧 技術スタック

### 新規追加ライブラリ
```
elevenlabs>=0.2.0
pygame>=2.5.0  # 音声再生用（または pyaudio）
python-dotenv>=1.0.0  # 環境変数管理
```

### API仕様
- **TTS Engine**: ElevenLabs v3
- **Voice**: kuon (マルチリンガル対応)
- **Output Format**: MP3 or WAV
- **Streaming**: 対応予定

---

## 📁 新規ファイル構成

```
~/aite/20251006/
├── elevenlabs_client.py       # ElevenLabs API client
├── voice_synthesis.py         # 音声合成システム
├── chat_with_voice.py         # 音声対応チャット（新規）
├── voice_cache/               # 音声キャッシュディレクトリ
├── .env.example               # 環境変数テンプレート
├── VOICE_SETUP.md             # 音声セットアップガイド
└── VOICE_SYNTHESIS_ROADMAP.md # このファイル
```

---

## ⚠️ 注意事項

### APIコスト管理
- ElevenLabs APIは従量課金
- 開発時はキャッシュ機能を活用
- API使用量のモニタリング実装

### セキュリティ
- APIキーは`.env`ファイルで管理
- `.gitignore`に`.env`を追加済み
- 環境変数サンプルとして`.env.example`を提供

### GPU非依存
- 音声合成はAPI経由のため、GPU不要
- ローカル環境でも実行可能（ネット接続必要）

---

## 🎬 デモシナリオ

### シナリオ1: 基本会話
```
ユーザー: 「牡丹、今日の調子はどう？」
牡丹（テキスト）: 「めっちゃ元気！オジサンは？」
牡丹（音声）: 🔊 [音声再生]
```

### シナリオ2: 感情表現
```
ユーザー: 「AI Vtuberとして配信するよ」
牡丹（テキスト）: 「マジで！？ヤバい、めっちゃ楽しみ！」
牡丹（音声）: 🔊 [驚き・喜びの音声]
```

---

## 🚀 次フェーズへの接続

### v1.2.0への準備
- 音声認識（Whisper）統合の基盤
- 双方向音声対話への橋渡し
- 音声データの蓄積と分析

### 将来的なローカルTTS移行
- 現在: ElevenLabs API（音質優先）
- 将来: ローカルTTSモデル（レイテンシー優先）
- このブランチはAPIとの疎結合設計を維持

---

## 📊 進捗管理

| タスク | 優先度 | ステータス | 担当 | 完了日 |
|--------|--------|-----------|------|---------|
| ElevenLabs API統合 | 最高 | ✅ 完了 | Claude Code | 2025-10-06 |
| 音声生成システム | 高 | ✅ 完了 | Claude Code | 2025-10-06 |
| 牡丹の声の確立 | 高 | ✅ 完了 | Claude Code | 2025-10-06 |
| チャット統合 | 中 | 🔄 進行中 | - | - |
| 音声評価システム | 中 | 🔲 未着手 | - | - |
| ドキュメント整備 | 中 | ✅ 完了 | Claude Code | 2025-10-06 |

---

**作成日**: 2025-10-06
**ブランチ作成**: feature/voice-synthesis
**目標バージョン**: v1.1.0
